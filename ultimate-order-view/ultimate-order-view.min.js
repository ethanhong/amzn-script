const e=React.createElement,SearchContext=React.createContext(),QRCodeContext=React.createContext();function injectCSS(){let t=`
    :root,
    body,
    html {
      box-sizing: border-box;
    }
    
    div,
    table,
    thead,
    tbody,
    tr,
    th,
    td,
    a {
      margin: 0;
      padding: 0;
      border: 0;
      outline: none;
      font-size: 100%;
      vertical-align: baseline;
      background: transparent;
    }
    
    #ultimateTable-container {
      display: flex;
      flex-wrap: wrap;
      align-items: flex-start;
      margin: 0.5rem 0 1rem 0;
    }
    
    #bag-table {
      border-collapse: collapse;
      font-family: monospace;
      font-size: 1rem;
      color: #101010;
      margin-right: 1rem;
      margin-bottom: 0.5rem;
      border: 1px solid #888;
      box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
    }
    
    #bag-table th {
      background-color: #e8e8e8;
      padding: 0.6rem;
      text-align: center;
      vertical-align: middle;
    }
    
    #bag-table td {
      padding: 0.8rem 1rem;
      text-align: center;
      vertical-align: middle;
    }
    
    #bag-table tbody tr:nth-child(even) {
      background-color: #e8e8e8;
    }
    
    #bag-table tbody tr:hover {
      background-color: #ccc;
    }
    
    #qrcode-text {
      width: 100%;
      font-size: 0.8rem;
      line-height: 1.2rem;
      text-align: center;
      font-family: monospace;
    }
    
    tr.search-target {
      border: 2px solid firebrick;
    }
  `,r=document.createElement("style");r.innerText=t,document.head.appendChild(r)}function getBags(){let t=[],r=[...document.querySelectorAll("#picklists_table > tbody > tr")];r.shift();let o=r.map(t=>t.textContent.trim().split(/\s+/)),n=r.map(t=>t.querySelector("td:last-child > a"));for(let l=0;l<o.length;l+=1){let a={};a.picker={},[a.id,a.zone,a.status,a.spoo,a.pickerLogin]=o[l],a.pickerUrl=`/labor_tracking/lookup_history?user_name=${a.pickerLogin}`,a.packUrl=n[l].href,a.code=getBagCode(a.spoo),a.totalItem=getBagTotalItem(a.spoo),t.push(a)}return t}function isValidCode(t){return Boolean(t.match(/[a-z,A-z,0-9]{20}/))}function getBagCode(t){if(!isValidCode(t))return"-";let r=[...document.querySelectorAll("a")].find(r=>r.textContent===t),o=r.parentNode.childNodes[5].textContent.trim().split(/\s+/);return o[1]||"-"}function getBagTotalItem(t){if(!isValidCode(t))return"-";let r=[...document.querySelectorAll("a")].find(r=>r.textContent===t),o=r.parentNode.childNodes[7].textContent.trim().split(/\s+/);return o[0]||"-"}function BagRow({bag:t,completionTime:r}){let{searchTerm:o}=React.useContext(SearchContext),{setQRCodeContent:n}=React.useContext(QRCodeContext),l=t=>{let r=t.target.textContent;isValidCode(r)&&n(r)},a=e("a",{href:t.pickerUrl},`${t.pickerLogin}`),i=e("a",{href:t.packUrl},"Pack"),d=[e("td",null,t.id),e("td",null,t.zone),e("td",null,t.status),e("td",null,r),e("td",{onClick:l},t.code),e("td",{onClick:l},t.spoo),e("td",null,a),e("td",null,`${t.totalItem} items`),e("td",null,i),],c=o.toUpperCase(),s=t.code.toUpperCase(),u=t.spoo.toUpperCase(),g=c&&(containsKeyword(s,c)||containsKeyword(u,c))?{className:"search-target"}:null;return e("tr",g,d)}function containsKeyword(t,r){return t.indexOf(r)>-1}function BagTable(){let t=e("tr",null,["ID","Zone","Status","Completion Time","Tracking Code","Spoo","Picker","Total Items","",].map(t=>e("th",null,`${t}`))),r=getBags(),[o,n]=React.useState(Array(r.length).fill("-"));React.useEffect(()=>{for(let t=0;t<r.length;t+=1){let o=r[t];fetch(`/wms/view_picklist_history?picklist_id=${encodeURIComponent(o.id)}`).then(t=>t.text()).then(t=>extractCompletionTime(t)).then(r=>n(o=>[...o.slice(0,t),r,...o.slice(t+1),]))}},[]);let l=r.map((t,r)=>e(BagRow,{bag:t,completionTime:o[r]}));return e("table",{id:"bag-table"},[e("thead",null,t),e("tbody",null,l)])}function extractCompletionTime(t){let r=new DOMParser().parseFromString(t,"text/html"),o=r.querySelector("body > table:nth-child(6) > tbody > tr:nth-child(6)").textContent.match(/\d{1,2}:\d{1,2}/);return o||"-"}function makeQRCode(t){return new QRCode(document.querySelector("#qrcode-container"),{text:t,width:160,height:160,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H})}function QRCodeArea(){let{qrcodeContent:t}=React.useContext(QRCodeContext),r=e("div",{id:"qrcode-container"}),o=e("div",{id:"qrcode-text"},t);return e("div",{id:"qrcode-area"},[r,o])}function SearchBar(){let{searchTerm:t,setsearchTerm:r}=React.useContext(SearchContext),o=t=>r(t.target.value);return e("form",null,[e("input",{type:"text",placeholder:"Search by tracking-code or spoo",size:"30",value:t,onChange:o,style:{lineHeight:"1.5rem"}})])}let qrcodeMaker=null;function UltimateTable(){let[t,r]=React.useState("");React.useEffect(()=>{t&&(null===qrcodeMaker?qrcodeMaker=makeQRCode(t):qrcodeMaker.makeCode(t))},[t]);let o=e(BagTable),n=e(QRCodeArea),l=e("div",{id:"ultimateTable-container"},[o,n,]);return e(QRCodeContext.Provider,{value:{qrcodeContent:t,setQRCodeContent:r}},l)}function App(){let[t,r]=React.useState("");return e(SearchContext.Provider,{value:{searchTerm:t,setsearchTerm:r}},[e(SearchBar),e(UltimateTable),])}function getLogin(){return document.getElementsByTagName("span")[0].innerHTML.match(/\(([^)]+)\)/)[1]}function isVerifiedUser(t){return console.log(`hello, ${t}`),!0}function ultimateOrderView(){if(!isVerifiedUser(getLogin()))return;let t=document.createElement("div");t.setAttribute("id","root"),document.body.insertBefore(t,document.querySelector("#orders_form")),ReactDOM.render(e(App),document.querySelector("#root")),injectCSS()}